<?xml version="1.0"?>
<!--
 cleaning_robot のURDFファイル。
 自律清掃ロボットのような2輪差動駆動＋LIDAR＋カメラを持つ単純モデル。
 各リンクの形状、材質、座標系の構造が定義されている。
-->
<robot name="cleaning_robot">

  <!--==============================================================
      材質(Material)定義：visual（見た目）の色を設定
  ==============================================================-->
  <material name="blue">
    <color rgba="0 0 0.8 1"/> <!-- 青色（不透明） -->
  </material>
  <material name="black">
    <color rgba="0 0 0 1"/> <!-- 黒色 -->
  </material>
  <material name="white">
    <color rgba="1 1 1 1"/> <!-- 白色 -->
  </material>
  <material name="red">
    <color rgba="1 0 0 1"/> <!-- 赤色 -->
  </material>

  <!--==============================================================
      base_footprint：移動ロボットで一般的な "地面基準" フレーム
      実際の形状は持たない（リンク名のみの空リンク）
  ==============================================================-->
  <link name="base_footprint"/>

  <!--==============================================================
      base_joint：base_footprint → base_link の固定ジョイント
      base_link を地面座標系（base_footprint）に対して 10cm 上に配置。
  ==============================================================-->
  <joint name="base_joint" type="fixed">
    <parent link="base_footprint"/>
    <child link="base_link"/>
    <origin xyz="0 0 0.0391" rpy="0 0 0"/>
  </joint>

  <!--==============================================================
      base_link：ロボット本体の基本シャーシ
      幅0.60m、奥行0.40m、高さ0.20m の直方体で表現。
  ==============================================================-->
  <link name="base_link">
    <visual>
      <geometry>
        <box size="0.50 0.50 0.20"/> <!-- シャーシの大きさ -->
      </geometry>
      <material name="blue"/> <!-- 青色表示 -->
      <origin xyz="0 0 0.10" rpy="0 0 0"/> 
      <!-- シャーシ中心を base_link 原点からさらに10cm上へ。
           つまり base_link 原点はシャーシ底面付近になる。 -->
    </visual>

    <collision>
      <geometry>
        <box size="0.50 0.50 0.20"/> <!-- 衝突モデルも同じ形状 -->
      </geometry>
      <origin xyz="0 0 0.10" rpy="0 0 0"/>
      <!-- 衝突計算用の原点設定も visual と一致させている -->
    </collision>
  </link>

  <!--==============================================================
      left_wheel：左車輪
      円柱で表現（半径0.10m、厚み0.05m）
      origin の rpy で x軸回転（1.57075 rad ≒ 90度）し、
      ホイールの回転軸が Y軸方向になるように合わせている。
  ==============================================================-->
  <link name="left_wheel">
    <visual>
      <geometry>
        <cylinder length="0.05" radius="0.0391"/>
      </geometry>
      <material name="black"/>
      <origin rpy="1.57075 0 0" xyz="0 0 0"/>
    </visual>
  </link>

  <!-- 左車輪ジョイント：base_link と left_wheel を接続 -->
  <joint name="left_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="left_wheel"/>
    <origin xyz="0 0.212 0" rpy="0 0 0"/>
    <!-- base_link の中心から左側（y+方向）に 0.225m 位置。 -->
    <axis xyz="0 1 0"/> <!-- Y軸回りに回転（ホイール回転軸） -->
  </joint>

  <!--==============================================================
      right_wheel：右車輪（左車輪と対称）
  ==============================================================-->
  <link name="right_wheel">
    <visual>
      <geometry>
        <cylinder length="0.05" radius="0.0391"/>
      </geometry>
      <material name="black"/>
      <origin rpy="1.57075 0 0" xyz="0 0 0"/>
    </visual>
  </link>

  <!-- 右車輪ジョイント：base_link と right_wheel を接続 -->
  <joint name="right_wheel_joint" type="continuous">
    <parent link="base_link"/>
    <child link="right_wheel"/>
    <origin xyz="0 -0.212 0" rpy="0 0 0"/>
    <!-- base_link から右側（y-方向）に 0.225m -->
    <axis xyz="0 1 0"/> <!-- こちらも Y軸回転 -->
  </joint>

  <!--==============================================================
      laser：LIDAR のフレーム
      小さな円柱で可視化
  ==============================================================-->
  <link name="laser">
    <visual>
      <geometry>
        <cylinder length="0.04" radius="0.035"/>
      </geometry>
      <material name="black"/>
    </visual>
  </link>

  <!-- LIDAR の固定ジョイント：base_footprint → laser -->
  <joint name="lidar_joint" type="fixed">
    <parent link="base_link"/>
    <child link="laser"/>
    <origin xyz="0 0 0.105" rpy="3.14159 0 0"/>
    <!-- 高さ20.5cmに設置(base_linkから+10.5cm)。上下逆さま(Roll=180度)。 -->
  </joint>

  <!--==============================================================
      camera：カメラ本体
      小型箱型で表現
  ==============================================================-->
  <link name="camera">
    <visual>
      <geometry>
        <box size="0.02 0.05 0.02"/> <!-- 小さな直方体のカメラ -->
      </geometry>
      <material name="red"/>
    </visual>
  </link>

  <!-- カメラ固定ジョイント：base_footprint → camera -->
  <joint name="camera_joint" type="fixed">
    <parent link="base_link"/>
    <child link="camera"/>
    <origin xyz="0.15 0 0.3" rpy="-1.5707 0 -1.5707"/>
    <!-- 前方向に15cm、上方向に30cm。
         ロボット前面の高い位置に設置されている。 -->
  </joint>

</robot>

